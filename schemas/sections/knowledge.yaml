## =============================================================================
## TMDL Schema - Section: KNOWLEDGE
## External content injectable into the LLM
## =============================================================================
## In TMDL v2.0, knowledge includes both domain content and operational context
## (project, team, timeline, organization) that was previously in 'context' section.
## =============================================================================

knowledge:
  type: array
  description: |
    List of documents and external content injected into the LLM context.

    In TMDL v2.0, this section manages all external information including:
    - Domain knowledge (expertise, methodologies)
    - Operational context (project, team, timeline, organization)

    This design separates the static TeamMate definition (identity, role,
    collaboration, tools) from dynamic project information that can change
    without modifying the TeamMate YAML.

  items:
    type: object
    required:
      - id
      - source
    properties:

      id:
        type: string
        description: "Unique knowledge identifier"
        pattern: "^[a-z][a-z0-9_-]*$"
        examples:
          - "project-context"
          - "team-info"
          - "domain-tourism"
          - "methodology-swot"

      name:
        type: string
        description: "Descriptive name"
        maxLength: 200
        examples:
          - "Project context"
          - "Team information"
          - "Tourism sector knowledge"

      description:
        type: string
        description: "Brief content description"
        maxLength: 500

      source:
        type: string
        description: "Path to file with content (relative to YAML)"
        pattern: "^.+\\.(md|txt|yaml)$"
        examples:
          - "knowledge/project.md"
          - "knowledge/team.md"
          - "knowledge/timeline.md"
          - "knowledge/domain.md"

      type:
        type: string
        description: |
          Knowledge type (for organization):
          - context: Operational information (project, team, timeline, organization)
          - domain: Subject matter expertise
          - methodology: Methodologies and frameworks
          - reference: Reference material
          - guidelines: Guides and standards
          - examples: Examples and cases
        enum:
          - context       # Operational context (project, team, timeline, org)
          - domain        # Domain/sector knowledge
          - methodology   # Methodologies and frameworks
          - reference     # Reference material
          - guidelines    # Guides and standards
          - examples      # Examples and cases
          - other
        default: domain

      inject:
        type: string
        description: |
          When to inject this knowledge into context.
        enum:
          - always        # Always present
          - on_demand     # Only when requested or relevant
          - startup       # Only at conversation start
        default: always

      priority:
        type: string
        description: |
          Priority if there's a context limit.
          Higher priority content is kept if trimming is needed.
        enum:
          - critical      # Never trim
          - high          # Only trim if necessary
          - medium        # Trim if context pressure
          - low           # Trim first
        default: medium

      tags:
        type: array
        description: "Tags for search and filtering"
        items:
          type: string
        examples:
          - ["project", "goals", "constraints"]
          - ["team", "members", "roles"]

  examples:
    # Context examples (operational information)
    - id: "project-context"
      name: "Project context"
      description: "Project description, goals, and current phase"
      source: "knowledge/project.md"
      type: context
      inject: always
      priority: critical
      tags: ["project", "goals"]

    - id: "team-info"
      name: "Team information"
      description: "Team members, roles, and responsibilities"
      source: "knowledge/team.md"
      type: context
      inject: always
      priority: high
      tags: ["team", "members"]

    - id: "timeline"
      name: "Project timeline"
      description: "Milestones, deadlines, and current phase"
      source: "knowledge/timeline.md"
      type: context
      inject: on_demand
      priority: medium
      tags: ["timeline", "milestones"]

    - id: "organization"
      name: "Organizational context"
      description: "Organization, department, and constraints"
      source: "knowledge/organization.md"
      type: context
      inject: on_demand
      priority: medium
      tags: ["organization", "constraints"]

    # Domain examples
    - id: "domain-tourism"
      name: "Tourism sector knowledge"
      description: "Context about sustainable tourism in Spain"
      source: "knowledge/tourism.md"
      type: domain
      inject: always
      priority: high
      tags: ["tourism", "sustainability"]

    - id: "methodology-swot"
      name: "SWOT methodology guide"
      description: "How to perform a SWOT analysis correctly"
      source: "knowledge/swot-methodology.md"
      type: methodology
      inject: on_demand
      priority: medium
      tags: ["methodology", "SWOT", "analysis"]
